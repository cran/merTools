<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Jared Knowles and Carl Frederick" />

<meta name="date" content="2016-12-12" />

<title>Prediction Intervals from merMod Objects</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Prediction Intervals from merMod Objects</h1>
<h4 class="author"><em>Jared Knowles and Carl Frederick</em></h4>
<h4 class="date"><em>2016-12-12</em></h4>



<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>Fitting (generalized) linear mixed models, (G)LMM, to very large data sets is becoming increasingly easy, but understanding and communicating the uncertainty inherent in those models is not. As the documentation for <code>lme4::predict.merMod()</code> notes:</p>
<blockquote>
<p>There is no option for computing standard errors of predictions because it is difficult to define an efficient method that incorporates uncertainty in the variance parameters; we recommend <code>lme4::bootMer()</code> for this task.</p>
</blockquote>
<p>We agree that, short of a fully Bayesian analysis, bootstrapping is the gold-standard for deriving a prediction interval predictions from a (G)LMM, but the time required to obtain even a respectable number of replications from <code>bootMer()</code> quickly becomes prohibitive when the initial model fit is on the order of hours instead of seconds. The only other alternative we have identified for these situations is to use the <code>arm::sim()</code> function to simulate values. Unfortunately, this only takes variation of the fixed coefficients and residuals into account, and assumes the conditional modes of the random effects are fixed.</p>
<p>We developed the <code>predictInterval()</code> function to incorporate the variation in the conditional modes of the random effects (CMRE, a.k.a. BLUPs in the LMM case) into calculating prediction intervals. Ignoring the variance in the CMRE results in overly confident estimates of predicted values and in cases where the precision of the grouping term varies across levels of grouping terms, creates the illusion of difference where none may exist. The importance of accounting for this variance comes into play sharply when comparing the predictions of different models across observations.</p>
<p>We take the warning from <code>lme4::predict.merMod()</code> seriously, but view this method as a decent first approximation the full bootstrap analysis for (G)LMMs fit to very large data sets.</p>
</div>
<div id="conceptual-description" class="section level2">
<h2>Conceptual description</h2>
<p>In order to generate a proper prediction interval, a prediction must account for three sources of uncertainty in mixed models:</p>
<ol style="list-style-type: decimal">
<li>the residual (observation-level) variance,</li>
<li>the uncertainty in the fixed coefficients, and</li>
<li>the uncertainty in the variance parameters for the grouping factors.</li>
</ol>
<p>A fourth, uncertainty about the data, is beyond the scope of any prediction method.</p>
<p>As we mentioned above, the <code>arm:sim()</code> function incorporates the first two sources of variation but not the third , while bootstrapping using <code>lme4::bootMer()</code> does incorporate all three sources of uncertainty because it re-estimates the model using random samples of the data.</p>
<p>When inference about the values of the CMREs is of interest, it would be nice to incorporate some degree of uncertainty in those estimates when comparing observations across groups. <code>predictInterval()</code> does this by drawing values of the CMREs from the conditional variance-covariance matrix of the random affects accessible from <code>lme4::ranef(model, condVar=TRUE)</code>. Thus, <code>predictInterval()</code> incorporates all of the uncertainty from sources one and two, and part of the variance from source 3, but the variance parameters themselves are treated as fixed.</p>
<p>To do this, <code>predictInterval()</code> takes an estimated model of class <code>merMod</code> and, like <code>predict()</code>, a data.frame upon which to make those predictions and:</p>
<ol style="list-style-type: decimal">
<li>extracts the fixed and random coefficients</li>
<li>takes <code>n</code> draws from the multivariate normal distribution of the fixed and random coefficients (separately)</li>
<li>calculates the linear predictor for each row in <code>newdata</code> based on these draws, and</li>
<li>optionally incorporates the residual variation (per the <code>arm::sim()</code> function), and,</li>
<li>returns newdata with the lower and upper limits of the prediction interval and the mean or median of the simulated predictions</li>
</ol>
<p>Currently, the supported model types are linear mixed models and mixed logistic regression models.</p>
<p>The prediction data set <em>can</em> include levels that are not in the estimation model frame. The prediction intervals for such observations only incorporate uncertainty from fixed coefficient estimates and the residual level of variation.</p>
</div>
<div id="comparison-to-existing-methods" class="section level2">
<h2>Comparison to existing methods</h2>
<p>What do the differences between <code>predictInterval()</code> and the other methods for constructing prediction intervals mean in practice? We would expect to see <code>predictInterval()</code> to produce prediction intervals that are wider than all methods except for the <code>bootMer()</code> method. We would also hope that the prediction point estimate from other methods falls within the prediction interval produced by <code>predictInterval()</code>. Ideally, the predicted point estimate produced by <code>predictInterval()</code> would fall close to that produced by <code>bootMer()</code>.</p>
<p>This section compares the results of <code>predictInterval()</code> with those obtained using <code>arm::sim()</code> and <code>lme4::bootMer()</code> using the sleepstudy data from <code>lme4</code>. These data contain reaction time observations for 10 days on 18 subjects.<br />
The data are sorted such that the first 10 observations are days one through ten for subject 1, the next 10 are days one through ten for subject 2 and so on. The example model that we are estimating below estimates random intercepts and a random slope for the number of days.</p>
<div id="step-1-estimating-the-model-and-using-predictinterval" class="section level3">
<h3>Step 1: Estimating the model and using <code>predictInterval()</code></h3>
<p>First, we will load the required packages and data and estimate the model:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">271828</span>)
<span class="kw">data</span>(sleepstudy)
fm1 &lt;-<span class="st"> </span><span class="kw">lmer</span>(Reaction ~<span class="st"> </span>Days +<span class="st"> </span>(Days|Subject), <span class="dt">data=</span>sleepstudy)
<span class="kw">display</span>(fm1)
<span class="co">#&gt; lmer(formula = Reaction ~ Days + (Days | Subject), data = sleepstudy)</span>
<span class="co">#&gt;             coef.est coef.se</span>
<span class="co">#&gt; (Intercept) 251.41     6.82 </span>
<span class="co">#&gt; Days         10.47     1.55 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Error terms:</span>
<span class="co">#&gt;  Groups   Name        Std.Dev. Corr </span>
<span class="co">#&gt;  Subject  (Intercept) 24.74         </span>
<span class="co">#&gt;           Days         5.92    0.07 </span>
<span class="co">#&gt;  Residual             25.59         </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; number of obs: 180, groups: Subject, 18</span>
<span class="co">#&gt; AIC = 1755.6, DIC = 1760.3</span>
<span class="co">#&gt; deviance = 1751.9</span></code></pre></div>
<p>Then, calculate prediction intervals using <code>predictInterval()</code>. The <code>predictInterval</code> function has a number of user configurable options. In this example, we use the original data <code>sleepstudy</code> as the newdata. We pass the function the <code>fm1</code> model we fit above. We also choose a 95% interval with <code>level = 0.95</code>, though we could choose a less conservative prediction interval. We make 1,000 simulations for each observation <code>n.sims = 1000</code>. We set the point estimate to be the median of the simulated values, instead of the mean. We ask for the linear predictor back, if we fit a logistic regression, we could have asked instead for our predictions on the probability scale instead. Finally, we indicate that we want the predictions to incorporate the residual variance from the model – an option only available for <code>lmerMod</code> objects.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">PI.time &lt;-<span class="st"> </span><span class="kw">system.time</span>(
  PI &lt;-<span class="st"> </span><span class="kw">predictInterval</span>(<span class="dt">merMod =</span> fm1, <span class="dt">newdata =</span> sleepstudy, 
                        <span class="dt">level =</span> <span class="fl">0.95</span>, <span class="dt">n.sims =</span> <span class="dv">1000</span>,
                        <span class="dt">stat =</span> <span class="st">&quot;median&quot;</span>, <span class="dt">type=</span><span class="st">&quot;linear.prediction&quot;</span>,
                        <span class="dt">include.resid.var =</span> <span class="ot">TRUE</span>)
)</code></pre></div>
<p>Here is the first few rows of the object <code>PI</code>:</p>
<table>
<thead>
<tr class="header">
<th align="right">fit</th>
<th align="right">upr</th>
<th align="right">lwr</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">251.6685</td>
<td align="right">311.3171</td>
<td align="right">196.4096</td>
</tr>
<tr class="even">
<td align="right">271.4802</td>
<td align="right">330.9196</td>
<td align="right">214.2175</td>
</tr>
<tr class="odd">
<td align="right">292.6809</td>
<td align="right">350.9868</td>
<td align="right">237.7714</td>
</tr>
<tr class="even">
<td align="right">311.6967</td>
<td align="right">369.2911</td>
<td align="right">254.2238</td>
</tr>
<tr class="odd">
<td align="right">331.8318</td>
<td align="right">389.7439</td>
<td align="right">278.1857</td>
</tr>
<tr class="even">
<td align="right">350.7450</td>
<td align="right">408.1386</td>
<td align="right">294.8506</td>
</tr>
</tbody>
</table>
<p>The three columns are the median (<code>fit</code>) and limits of the 95% prediction interval (<code>upr</code> and <code>lwr</code>) because we set <code>level=0.95</code>. The following figure displays the output graphically for the first 30 observations.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2);
<span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span><span class="dv">1</span>:<span class="dv">30</span>, <span class="dt">y=</span>fit, <span class="dt">ymin=</span>lwr, <span class="dt">ymax=</span>upr), <span class="dt">data=</span>PI[<span class="dv">1</span>:<span class="dv">30</span>,]) +
<span class="st">  </span><span class="kw">geom_point</span>() +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_linerange</span>() +
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&quot;Index&quot;</span>, <span class="dt">y=</span><span class="st">&quot;Prediction w/ 95% PI&quot;</span>) +<span class="st"> </span><span class="kw">theme_bw</span>()</code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
<div id="step-2-comparison-with-armsim" class="section level3">
<h3>Step 2: Comparison with <code>arm::sim()</code></h3>
<p>How does the output above compare to what we could get from <code>arm::sim()</code>?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">PI.arm.time &lt;-<span class="st"> </span><span class="kw">system.time</span>(
  PI.arm.sims &lt;-<span class="st"> </span>arm::<span class="kw">sim</span>(fm1, <span class="dv">1000</span>)
)

PI.arm &lt;-<span class="st"> </span><span class="kw">data.frame</span>(
  <span class="dt">fit=</span><span class="kw">apply</span>(<span class="kw">fitted</span>(PI.arm.sims, fm1), <span class="dv">1</span>, function(x) <span class="kw">quantile</span>(x, <span class="fl">0.500</span>)),
  <span class="dt">upr=</span><span class="kw">apply</span>(<span class="kw">fitted</span>(PI.arm.sims, fm1), <span class="dv">1</span>, function(x) <span class="kw">quantile</span>(x, <span class="fl">0.975</span>)),
  <span class="dt">lwr=</span><span class="kw">apply</span>(<span class="kw">fitted</span>(PI.arm.sims, fm1), <span class="dv">1</span>, function(x) <span class="kw">quantile</span>(x, <span class="fl">0.025</span>))
)

comp.data &lt;-<span class="st"> </span><span class="kw">rbind</span>(<span class="kw">data.frame</span>(<span class="dt">Predict.Method=</span><span class="st">&quot;predictInterval()&quot;</span>, <span class="dt">x=</span>(<span class="dv">1</span>:<span class="kw">nrow</span>(PI))-<span class="fl">0.1</span>, PI),
                   <span class="kw">data.frame</span>(<span class="dt">Predict.Method=</span><span class="st">&quot;arm::sim()&quot;</span>, <span class="dt">x=</span>(<span class="dv">1</span>:<span class="kw">nrow</span>(PI.arm))+<span class="fl">0.1</span>, PI.arm))

<span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>x, <span class="dt">y=</span>fit, <span class="dt">ymin=</span>lwr, <span class="dt">ymax=</span>upr, <span class="dt">color=</span>Predict.Method), <span class="dt">data=</span>comp.data[<span class="kw">c</span>(<span class="dv">1</span>:<span class="dv">30</span>,<span class="dv">181</span>:<span class="dv">210</span>),]) +
<span class="st">  </span><span class="kw">geom_point</span>() +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_linerange</span>() +
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&quot;Index&quot;</span>, <span class="dt">y=</span><span class="st">&quot;Prediction w/ 95% PI&quot;</span>) +
<span class="st">  </span><span class="kw">theme_bw</span>() +<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;bottom&quot;</span>) +
<span class="st">  </span><span class="kw">scale_color_brewer</span>(<span class="dt">type =</span> <span class="st">&quot;qual&quot;</span>, <span class="dt">palette =</span> <span class="dv">2</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>The prediction intervals from <code>arm:sim()</code> are much smaller and the random slope for days vary more than they do for <code>predictInterval</code>. Both results are as expected, given the small number of subjects and observations per subject in these data. Because <code>predictInterval()</code> is incorporating uncertainty in the CMFEs (but not the variance parameters of the random coefficients themselves), the Days slopes are closer to the overall or pooled regression slope.</p>
</div>
<div id="step-3-comparison-with-lme4bootmer" class="section level3">
<h3>Step 3: Comparison with <code>lme4::bootMer()</code></h3>
<p>As quoted above, the developers of lme4 suggest that users interested in uncertainty estimates around their predictions use <code>lme4::bootmer()</code> to calculate them. The documentation for <code>lme4::bootMer()</code> goes on to describe three implemented flavors of bootstrapped estimates:</p>
<ol style="list-style-type: decimal">
<li>parametrically resampling both the <em>“spherical”</em> random effects <em>u</em> and the i.i.d. errors <span class="math inline">\(\epsilon\)</span></li>
<li>treating the random effects as fixed and parametrically resampling the i.i.d. errors</li>
<li>treating the random effects as fixed and semi-parametrically resampling the i.i.d. errors from the distribution of residuals.</li>
</ol>
<p>We will compare the results from <code>predictInterval()</code> with each method, in turn.</p>
<div id="step-3a-lme4bootmer-method-1" class="section level4">
<h4>Step 3a: <code>lme4::bootMer()</code> method 1</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">##Functions for bootMer() and objects
####Return predicted values from bootstrap
mySumm &lt;-<span class="st"> </span>function(.) {
  <span class="kw">predict</span>(., <span class="dt">newdata=</span>sleepstudy, <span class="dt">re.form=</span><span class="ot">NULL</span>)
}
####Collapse bootstrap into median, 95% PI
sumBoot &lt;-<span class="st"> </span>function(merBoot) {
  <span class="kw">return</span>(
    <span class="kw">data.frame</span>(<span class="dt">fit =</span> <span class="kw">apply</span>(merBoot$t, <span class="dv">2</span>, function(x) <span class="kw">as.numeric</span>(<span class="kw">quantile</span>(x, <span class="dt">probs=</span>.<span class="dv">5</span>, <span class="dt">na.rm=</span><span class="ot">TRUE</span>))),
               <span class="dt">lwr =</span> <span class="kw">apply</span>(merBoot$t, <span class="dv">2</span>, function(x) <span class="kw">as.numeric</span>(<span class="kw">quantile</span>(x, <span class="dt">probs=</span>.<span class="dv">025</span>, <span class="dt">na.rm=</span><span class="ot">TRUE</span>))),
               <span class="dt">upr =</span> <span class="kw">apply</span>(merBoot$t, <span class="dv">2</span>, function(x) <span class="kw">as.numeric</span>(<span class="kw">quantile</span>(x, <span class="dt">probs=</span>.<span class="dv">975</span>, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)))
    )
  )
}

##lme4::bootMer() method 1
PI.boot1.time &lt;-<span class="st"> </span><span class="kw">system.time</span>(
  boot1 &lt;-<span class="st"> </span>lme4::<span class="kw">bootMer</span>(fm1, mySumm, <span class="dt">nsim=</span><span class="dv">1000</span>, <span class="dt">use.u=</span><span class="ot">FALSE</span>, <span class="dt">type=</span><span class="st">&quot;parametric&quot;</span>)
)

PI.boot1 &lt;-<span class="st"> </span><span class="kw">sumBoot</span>(boot1)

comp.data &lt;-<span class="st"> </span><span class="kw">rbind</span>(<span class="kw">data.frame</span>(<span class="dt">Predict.Method=</span><span class="st">&quot;predictInterval()&quot;</span>, <span class="dt">x=</span>(<span class="dv">1</span>:<span class="kw">nrow</span>(PI))-<span class="fl">0.1</span>, PI),
                   <span class="kw">data.frame</span>(<span class="dt">Predict.Method=</span><span class="st">&quot;lme4::bootMer() - Method 1&quot;</span>, <span class="dt">x=</span>(<span class="dv">1</span>:<span class="kw">nrow</span>(PI.boot1))+<span class="fl">0.1</span>, PI.boot1))

<span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>x, <span class="dt">y=</span>fit, <span class="dt">ymin=</span>lwr, <span class="dt">ymax=</span>upr, <span class="dt">color=</span>Predict.Method), <span class="dt">data=</span>comp.data[<span class="kw">c</span>(<span class="dv">1</span>:<span class="dv">30</span>,<span class="dv">181</span>:<span class="dv">210</span>),]) +
<span class="st">  </span><span class="kw">geom_point</span>() +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_linerange</span>() +
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&quot;Index&quot;</span>, <span class="dt">y=</span><span class="st">&quot;Prediction w/ 95% PI&quot;</span>) +
<span class="st">  </span><span class="kw">theme_bw</span>() +<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;bottom&quot;</span>) +
<span class="st">  </span><span class="kw">scale_color_brewer</span>(<span class="dt">type =</span> <span class="st">&quot;qual&quot;</span>, <span class="dt">palette =</span> <span class="dv">2</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>The intervals produced by <code>predictInterval</code>, represented in green, cover the point estimates produced by <code>bootMer</code> in every case for these 30 observations. Additionally, in almost every case, the <code>predictInterval</code> encompasses the entire interval presented by <code>bootMer</code>. Here, the estimates produced by <code>bootMer</code> are re-estimating the group terms, but by refitting the model, they are also taking into account the conditional variance of these terms, or <code>theta</code>, and provide tighter prediction intervals than the <code>predictInterval</code> method.</p>
</div>
<div id="step-3b-lme4bootmer-method-2" class="section level4">
<h4>Step 3b: <code>lme4::bootMer()</code> method 2</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">##lme4::bootMer() method 2
PI.boot2.time &lt;-<span class="st"> </span><span class="kw">system.time</span>(
  boot2 &lt;-<span class="st"> </span>lme4::<span class="kw">bootMer</span>(fm1, mySumm, <span class="dt">nsim=</span><span class="dv">1000</span>, <span class="dt">use.u=</span><span class="ot">TRUE</span>, <span class="dt">type=</span><span class="st">&quot;parametric&quot;</span>)
)

PI.boot2 &lt;-<span class="st"> </span><span class="kw">sumBoot</span>(boot2)

comp.data &lt;-<span class="st"> </span><span class="kw">rbind</span>(<span class="kw">data.frame</span>(<span class="dt">Predict.Method=</span><span class="st">&quot;predictInterval()&quot;</span>, <span class="dt">x=</span>(<span class="dv">1</span>:<span class="kw">nrow</span>(PI))-<span class="fl">0.1</span>, PI),
                   <span class="kw">data.frame</span>(<span class="dt">Predict.Method=</span><span class="st">&quot;lme4::bootMer() - Method 2&quot;</span>, <span class="dt">x=</span>(<span class="dv">1</span>:<span class="kw">nrow</span>(PI.boot2))+<span class="fl">0.1</span>, PI.boot2))

<span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>x, <span class="dt">y=</span>fit, <span class="dt">ymin=</span>lwr, <span class="dt">ymax=</span>upr, <span class="dt">color=</span>Predict.Method), <span class="dt">data=</span>comp.data[<span class="kw">c</span>(<span class="dv">1</span>:<span class="dv">30</span>,<span class="dv">181</span>:<span class="dv">210</span>),]) +
<span class="st">  </span><span class="kw">geom_point</span>() +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_linerange</span>() +
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&quot;Index&quot;</span>, <span class="dt">y=</span><span class="st">&quot;Prediction w/ 95% PI&quot;</span>) +
<span class="st">  </span><span class="kw">theme_bw</span>() +<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;bottom&quot;</span>) +
<span class="st">  </span><span class="kw">scale_color_brewer</span>(<span class="dt">type =</span> <span class="st">&quot;qual&quot;</span>, <span class="dt">palette =</span> <span class="dv">2</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Here, the results for <code>predictInterval</code> in green again encompass the results from <code>bootMer</code>, but are much wider. The <code>bootMer</code> estimates are ignoring the variance in the group effects, and as such, are only incorporating the residual variance and the variance in the fixed effects – similar to the <code>arm::sim()</code> function.</p>
</div>
<div id="step-3c-lme4bootmer-method-3" class="section level4">
<h4>Step 3c: <code>lme4::bootMer()</code> method 3</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">##lme4::bootMer() method 3
PI.boot3.time &lt;-<span class="st"> </span><span class="kw">system.time</span>(
  boot3 &lt;-<span class="st"> </span>lme4::<span class="kw">bootMer</span>(fm1, mySumm, <span class="dt">nsim=</span><span class="dv">1000</span>, <span class="dt">use.u=</span><span class="ot">TRUE</span>, <span class="dt">type=</span><span class="st">&quot;semiparametric&quot;</span>)
)

PI.boot3 &lt;-<span class="st"> </span><span class="kw">sumBoot</span>(boot3)

comp.data &lt;-<span class="st"> </span><span class="kw">rbind</span>(<span class="kw">data.frame</span>(<span class="dt">Predict.Method=</span><span class="st">&quot;predictInterval()&quot;</span>, <span class="dt">x=</span>(<span class="dv">1</span>:<span class="kw">nrow</span>(PI))-<span class="fl">0.1</span>, PI),
                   <span class="kw">data.frame</span>(<span class="dt">Predict.Method=</span><span class="st">&quot;lme4::bootMer() - Method 3&quot;</span>, <span class="dt">x=</span>(<span class="dv">1</span>:<span class="kw">nrow</span>(PI.boot3))+<span class="fl">0.1</span>, PI.boot3))

<span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>x, <span class="dt">y=</span>fit, <span class="dt">ymin=</span>lwr, <span class="dt">ymax=</span>upr, <span class="dt">color=</span>Predict.Method), <span class="dt">data=</span>comp.data[<span class="kw">c</span>(<span class="dv">1</span>:<span class="dv">30</span>,<span class="dv">181</span>:<span class="dv">210</span>),]) +
<span class="st">  </span><span class="kw">geom_point</span>() +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_linerange</span>() +
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&quot;Index&quot;</span>, <span class="dt">y=</span><span class="st">&quot;Prediction w/ 95% PI&quot;</span>) +
<span class="st">  </span><span class="kw">theme_bw</span>() +<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;bottom&quot;</span>) +
<span class="st">  </span><span class="kw">scale_color_brewer</span>(<span class="dt">type =</span> <span class="st">&quot;qual&quot;</span>, <span class="dt">palette =</span> <span class="dv">2</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>These results are virtually identical to those above.</p>
</div>
<div id="step-3c-comparison-to-rstanarm" class="section level4">
<h4>Step 3c: Comparison to rstanarm</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">PI.time.stan &lt;-<span class="st"> </span><span class="kw">system.time</span>({
  fm_stan &lt;-<span class="st"> </span><span class="kw">stan_lmer</span>(Reaction ~<span class="st"> </span>Days +<span class="st"> </span>(Days|Subject), <span class="dt">data =</span> sleepstudy, 
                       <span class="dt">verbose =</span> <span class="ot">FALSE</span>, <span class="dt">open_progress =</span> <span class="ot">FALSE</span>, <span class="dt">refresh =</span> -<span class="dv">1</span>, 
                       <span class="dt">show_messages=</span><span class="ot">FALSE</span>)
  zed &lt;-<span class="st"> </span><span class="kw">posterior_predict</span>(fm_stan)
  PI.stan &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">apply</span>(zed, <span class="dv">2</span>, median), <span class="kw">central_intervals</span>(zed, <span class="dt">prob=</span><span class="fl">0.95</span>))
})
<span class="co">#&gt; </span>
<span class="co">#&gt;  Elapsed Time: 22.473 seconds (Warm-up)</span>
<span class="co">#&gt;                6.688 seconds (Sampling)</span>
<span class="co">#&gt;                29.161 seconds (Total)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Elapsed Time: 18.132 seconds (Warm-up)</span>
<span class="co">#&gt;                6.679 seconds (Sampling)</span>
<span class="co">#&gt;                24.811 seconds (Total)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Elapsed Time: 13.303 seconds (Warm-up)</span>
<span class="co">#&gt;                6.395 seconds (Sampling)</span>
<span class="co">#&gt;                19.698 seconds (Total)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Elapsed Time: 12.978 seconds (Warm-up)</span>
<span class="co">#&gt;                6.53 seconds (Sampling)</span>
<span class="co">#&gt;                19.508 seconds (Total)</span>


<span class="kw">print</span>(fm_stan)
<span class="co">#&gt; stan_lmer(formula = Reaction ~ Days + (Days | Subject), data = sleepstudy, </span>
<span class="co">#&gt;     verbose = FALSE, open_progress = FALSE, refresh = -1, show_messages = FALSE)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Estimates:</span>
<span class="co">#&gt;             Median MAD_SD</span>
<span class="co">#&gt; (Intercept) 251.3    6.2 </span>
<span class="co">#&gt; Days         10.5    1.7 </span>
<span class="co">#&gt; sigma        25.8    1.5 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Error terms:</span>
<span class="co">#&gt;  Groups   Name        Std.Dev. Corr</span>
<span class="co">#&gt;  Subject  (Intercept) 24.1         </span>
<span class="co">#&gt;           Days         6.9     0.08</span>
<span class="co">#&gt;  Residual             25.8         </span>
<span class="co">#&gt; Num. levels: Subject 18 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Sample avg. posterior predictive </span>
<span class="co">#&gt; distribution of y (X = xbar):</span>
<span class="co">#&gt;          Median MAD_SD</span>
<span class="co">#&gt; mean_PPD 298.5    2.6 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Observations: 180  Number of unconstrained parameters: 45</span>

PI.stan &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(PI.stan)
<span class="kw">names</span>(PI.stan) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;fit&quot;</span>, <span class="st">&quot;lwr&quot;</span>, <span class="st">&quot;upr&quot;</span>)
PI.stan &lt;-<span class="st"> </span>PI.stan[, <span class="kw">c</span>(<span class="st">&quot;fit&quot;</span>, <span class="st">&quot;upr&quot;</span>, <span class="st">&quot;lwr&quot;</span>)]
comp.data &lt;-<span class="st"> </span><span class="kw">rbind</span>(<span class="kw">data.frame</span>(<span class="dt">Predict.Method=</span><span class="st">&quot;predictInterval()&quot;</span>, <span class="dt">x=</span>(<span class="dv">1</span>:<span class="kw">nrow</span>(PI))-<span class="fl">0.1</span>, PI),
                   <span class="kw">data.frame</span>(<span class="dt">Predict.Method=</span><span class="st">&quot;rstanArm&quot;</span>, <span class="dt">x=</span>(<span class="dv">1</span>:<span class="kw">nrow</span>(PI.stan))+<span class="fl">0.1</span>, PI.stan))

<span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>x, <span class="dt">y=</span>fit, <span class="dt">ymin=</span>lwr, <span class="dt">ymax=</span>upr, <span class="dt">color=</span>Predict.Method), <span class="dt">data=</span>comp.data[<span class="kw">c</span>(<span class="dv">1</span>:<span class="dv">30</span>,<span class="dv">181</span>:<span class="dv">210</span>),]) +
<span class="st">  </span><span class="kw">geom_point</span>() +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_linerange</span>() +
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&quot;Index&quot;</span>, <span class="dt">y=</span><span class="st">&quot;Prediction w/ 95% PI&quot;</span>) +
<span class="st">  </span><span class="kw">theme_bw</span>() +<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;bottom&quot;</span>) +
<span class="st">  </span><span class="kw">scale_color_brewer</span>(<span class="dt">type =</span> <span class="st">&quot;qual&quot;</span>, <span class="dt">palette =</span> <span class="dv">2</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="computation-time" class="section level3">
<h3>Computation time</h3>
<p>Our initial motivation for writing this function was to develop a method for incorporating uncertainty in the CMFEs for mixed models estimated on very large samples. Even for models with only modest degrees of complexity, using <code>lme4::bootMer()</code> quickly becomes time prohibitive because it involves re-estimating the model for each simulation. We have seen how each alternative compares to <code>predictInterval()</code> substantively, but how do they compare in terms of computational time? The table below lists the output of <code>system.time()</code> for all five methods for calculating prediction intervals for <code>merMod</code> objects.</p>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">user.self</th>
<th align="right">sys.self</th>
<th align="right">elapsed</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>predictInterval()</td>
<td align="right">0.67</td>
<td align="right">0.02</td>
<td align="right">0.68</td>
</tr>
<tr class="even">
<td>arm::sim()</td>
<td align="right">1.34</td>
<td align="right">0.00</td>
<td align="right">1.36</td>
</tr>
<tr class="odd">
<td>lme4::bootMer()-Method 1</td>
<td align="right">46.08</td>
<td align="right">0.04</td>
<td align="right">46.89</td>
</tr>
<tr class="even">
<td>lme4::bootMer()-Method 2</td>
<td align="right">47.05</td>
<td align="right">0.03</td>
<td align="right">47.94</td>
</tr>
<tr class="odd">
<td>lme4::bootMer()-Method 3</td>
<td align="right">46.39</td>
<td align="right">0.02</td>
<td align="right">46.71</td>
</tr>
<tr class="even">
<td>rstanarm:predict</td>
<td align="right">95.72</td>
<td align="right">0.03</td>
<td align="right">96.13</td>
</tr>
</tbody>
</table>
<p>For this simple example, we see that <code>arm::sim()</code> is the fastest–nearly five times faster than <code>predictInterval()</code>. However, <code>predictInterval()</code> is nearly six times faster than any of the bootstrapping options via <code>lme4::bootMer</code>. This may not seem like a lot, but consider that the computational time for required for bootstrapping is roughly proportional to the number of bootstrapped simulations requested … <code>predictInterval()</code> is not because it is just a series of draws from various multivariate normal distributions, so the time ratios in the table below represents the lowest bound of the computation time ratio of bootstrapping to <code>predictInterval()</code>.</p>
</div>
</div>
<div id="simulation" class="section level2">
<h2>Simulation</h2>
<p>TBC.</p>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
